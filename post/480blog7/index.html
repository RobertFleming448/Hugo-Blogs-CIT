<!DOCTYPE html>
<html lang="en">

<head>
    
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta name="HandheldFriendly" content="True" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta name="generator" content="Hugo 0.80.0" />


<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/dsrkafuu/dsr-cdn@1/images/favicons/dsrca/favicon.ico" />



<title>CIT 480 blog 7 - Robert Fleming&#39;s CIT Blog</title>


<meta name="author" content="Robert Fleming" />


<meta name="description" content="A minimal Hugo theme with nice theme color." />


<meta name="keywords" content="CIT-480, Ansible, PHP, Affinity" />


<meta property="og:title" content="CIT 480 blog 7" />
<meta name="twitter:title" content="CIT 480 blog 7" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://robertfleming448.github.io/post/480blog7/" /><meta property="og:description" content="Introduction This Blog will detail the trials and tribulations I faced while completing Lab 3. Lab 3 tasked us with yet again recompleting the steps of the prior lab autonomously. This lab required us to once again recreate the lamp stack using an Ansible playbook.
Ansible Installing Ansible was very easy. I already had Python on my machine so I was able to easily install Ansible using the apt-get install ansible command. From that point I made a simple playbook that would run on my local host (127.0. 0.1) so that I could see if everything was functioning. I had it install PHP through apt." />
<meta name="twitter:description" content="Introduction This Blog will detail the trials and tribulations I faced while completing Lab 3. Lab 3 tasked us with yet again recompleting the steps of the prior lab autonomously. This lab required us to once again recreate the lamp stack using an Ansible playbook.
Ansible Installing Ansible was very easy. I already had Python on my machine so I was able to easily install Ansible using the apt-get install ansible command. From that point I made a simple playbook that would run on my local host (127.0. 0.1) so that I could see if everything was functioning. I had it install PHP through apt." /><meta property="og:image" content="https://robertfleming448.github.io/img/og.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://robertfleming448.github.io/img/og.png" /><meta property="article:published_time" content="2021-02-17T23:53:42-08:00" /><meta property="article:modified_time" content="2021-02-17T23:53:42-08:00" />


<style>
    @media (prefers-color-scheme: dark) {
        body[data-theme='auto'] img {
            filter: brightness(60%);
        }
    }

    body[data-theme='dark'] img {
        filter: brightness(60%);
    }
</style>



<link rel="stylesheet" href="https://robertfleming448.github.io/assets/css/fuji.min.css" />





</head>

<body data-theme="auto">
    <script data-cfasync="false">
  
  var fujiThemeData = localStorage.getItem('fuji_data-theme');
  
  if (!fujiThemeData) {
    localStorage.setItem('fuji_data-theme', 'auto');
  } else {
    
    if (fujiThemeData !== 'auto') {
      document.body.setAttribute('data-theme', fujiThemeData === 'dark' ? 'dark' : 'light');
    }
  }
</script>
    <header>
    <div class="container-lg clearfix">
        <div class="col-12 header">
            <a class="title-main" href="https://robertfleming448.github.io">Robert Fleming&#39;s CIT Blog</a>
            
            <span class="title-sub">A Hugo blog for all my CIT antics</span>
            
        </div>
    </div>
</header>

    <main>
        <div class="container-lg clearfix">
            
            <div class="col-12 col-md-9 float-left content">
                
<article>
    
    <h2 class="post-item post-title">
        <a href="https://robertfleming448.github.io/post/480blog7/">CIT 480 blog 7</a>
    </h2>
    <div class="post-item post-meta">
        <span><i class="iconfont icon-today-sharp"></i>&nbsp;2021-02-17</span><span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;892 words</span><span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href="/tags/cit-480">CIT-480</a>&nbsp;<a href="/tags/ansible">Ansible</a>&nbsp;<a href="/tags/php">PHP</a>&nbsp;<a href="/tags/affinity">Affinity</a>&nbsp;</span>

    </div>
    
    <div class="post-content markdown-body">
        <h2 id="introduction">Introduction</h2>
<p>This Blog will detail the trials and tribulations I faced while completing Lab 3. Lab 3 tasked us with yet again recompleting the steps of the prior lab autonomously. This lab required us to once again recreate the lamp stack using an Ansible playbook.</p>
<h2 id="ansible">Ansible</h2>
<p>Installing Ansible was very easy. I already had Python on my machine so I was able to easily install Ansible using the <code>apt-get install ansible</code> command. From that point I made a simple playbook that would run on my local host <code>(127.0. 0.1)</code> so that I could see if everything was functioning. I had it install PHP through apt. After I ran the Playbook I checked my PHP version and confirmed the playbook ran as intended.</p>
<h2 id="issue-1-general-syntax-problems">Issue 1: General Syntax Problems</h2>
<p>While reviewing my notes and documentation online I struggled briefly with the playbook syntax. The required spaces were a little tiresome, but the error messages did help me figure that out. Additionally, some commands took a little while to figure out the formatting of. At first, I wrote several Apt tasks before realizing it could all be done in a single task. Overall, this step took the longest but it was by no means difficult.</p>
<h2 id="issue-2-php-installation">Issue 2: PHP Installation</h2>
<p>As is a common theme with these labs I become too focused on one aspect that I make stupid mistakes. This lab I wanted to run my Playbook on some AWS EC2 instances. AWS is a tool that I really want to become acquainted with so I thought it was only logical to implement it into my projects when possible. Now here is the part where I experienced tunnel vision. I was reviewing the steps the Professor made when spinning up EC2 instances and followed them to a T. This included the image used. Despite being aware that the lab required 18.04 Ubuntu containers, I still focused on the latest available image on AWS. This would spell trouble with several PHP installations and certainly made feel foolish when the “aha” moment finally clicked. After selecting the proper instance and changing the IP’s in my hosts.ini file, the PHP installation continued without further issues.</p>
<h2 id="issue-3-affinity-installation">Issue 3: Affinity Installation</h2>
<p>First, I’d like to show off my first two attempts as well as my reasoning behind them
Attempt 1:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Download Composer Installer</span>
    <span style="color:#f92672">get_url</span>:
      <span style="color:#f92672">url</span>: <span style="color:#ae81ff">https://getcomposer.org/installer</span>
      <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">/installer</span>
      <span style="color:#f92672">mode</span>: <span style="color:#ae81ff">777</span>
    <span style="color:#f92672">become</span>: <span style="color:#66d9ef">true</span>

  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Install Composer</span>
    <span style="color:#f92672">command</span>: <span style="color:#ae81ff">php -f installer  --install-dir=/usr/local/bin --filename=composer</span>
    <span style="color:#f92672">become</span>: <span style="color:#66d9ef">true</span>  </code></pre></div></p>
<br>
<p>In this attempt, my logic was to first download the installer using Ansible’s built in <code>get_url</code> module. Next, I would try to install it using the php -f command to install from a file. I chose to do this because in this case the command task would fail. My assumption was that the pipe broke it but I am unsure. In conclusion this did not work and to be honest I am not all too surprised. I’m not even certain the php command is formatted properly.</p>
<br>
<p>Attempt 2:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"> - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Install Composer</span>
    <span style="color:#f92672">command</span>: <span style="color:#ae81ff">composer install</span>
    <span style="color:#f92672">args</span>:
      <span style="color:#f92672">chdir</span>: <span style="color:#ae81ff">/var/www/html/affinity</span>
    <span style="color:#f92672">become</span>: <span style="color:#66d9ef">true</span>

  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Install Composer</span>
   <span style="color:#f92672">composer</span>:
      <span style="color:#f92672">command</span>: <span style="color:#ae81ff">install</span>
      <span style="color:#f92672">working_dir</span>: <span style="color:#ae81ff">/var/www/html/affinity</span>
    <span style="color:#f92672">become</span>: <span style="color:#66d9ef">true</span></code></pre></div></p>
<br>
<p>In this attempt I invested much more time and I had higher hopes. While not native, apparently a user created Ansible plugin exists to install composer packages. I tried this is several different ways, using multiple different formats and versions. I even tried using deprecated versions to no avail. This led me to my final solution.</p>
<br>
<p>Attempt 3 (The Winner):
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Composer Install Script</span>
    <span style="color:#f92672">script</span>: <span style="color:#ae81ff">script.sh</span>
    <span style="color:#f92672">args</span>:
      <span style="color:#f92672">chdir</span>: <span style="color:#ae81ff">/var/www/html/affinity</span>
    <span style="color:#f92672">become</span>: <span style="color:#66d9ef">true</span></code></pre></div></p>
<p>script.sh:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#! /bin/bash
</span><span style="color:#75715e"></span>
curl -sS https://getcomposer.org/installer | php -- --install-dir<span style="color:#f92672">=</span>/usr/local/bin --filename<span style="color:#f92672">=</span>composer
composer install</code></pre></div></p>
<br>
<p>Now I do consider this somewhat “cheating” but in the long end it did work. I could not find a single way of accomplishing the composer installation via commands however I did discover a handy script module. From my research apparently this makes the process take a little longer, but it was the only solution I tried that worked. In the end I prefer a solution that isn’t 100% efficient over one that doesn’t work at all.</p>
<h2 id="issue-4-overthinking">Issue 4: Overthinking</h2>
<p>This mistake was barely an issue but so I’ll touch briefly on it. After Apache2 was installed it began running immediately. After all the configuration I bever restarted the service. This led to the CSUN tech labs page not displaying and causing a little panic. After I SSH’ed into my EC2 instance and restarted apache2 manually I discovered my mistake. I added a restart apache task to my playbook and everything worked as intended. To make sure everything was working altogether I spun up 2 entirely new EC2 Ubuntu 18.04 instances and tried the playbook fresh. I was greeted by 2 functioning splash pages so I knew my work was done.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In the end I view this lab as a two-way learning experience. One I got to learn how to automate tasks on a remote machine using Ansible and two I was able to get some good AWS experience. Both of these skills I feel will be useful moving forward and I am starting to get ideas of how to incorporate these new technologies into my home life and scholastic projects. I may have struggled a bit more with this lab than prior ones, however it’s the struggle that makes finding the solution that much more enjoyable.</p>

    </div>
</article>


<div class="license markdown-body">
    <blockquote>
        <p>Unless otherwise noted, the content of this site is licensed under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"
               target="_blank">CC BY-NC-SA 4.0</a>.</p>
    </blockquote>
</div>



            </div>
            <aside class="col-12 col-md-3 float-left sidebar">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
            <li>
                <a href="https://github.com/RobertFleming448" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://www.linkedin.com/in/robert-fleming-16b4051b9/" target="_blank"><span>LinkedIn</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
            <span>
                <a href="/tags/3d-models/">3d-Models</a>
            </span>
            
            <span>
                <a href="/tags/affinity/">Affinity</a>
            </span>
            
            <span>
                <a href="/tags/ansible/">Ansible</a>
            </span>
            
            <span>
                <a href="/tags/apache/">Apache</a>
            </span>
            
            <span>
                <a href="/tags/aws/">AWS</a>
            </span>
            
            <span>
                <a href="/tags/cit-480/">CIT-480</a>
            </span>
            
            <span>
                <a href="/tags/cit-481/">CIT-481</a>
            </span>
            
            <span>
                <a href="/tags/docker/">Docker</a>
            </span>
            
            <span>
                <a href="/tags/freebsd/">FreeBSD</a>
            </span>
            
            <span>
                <a href="/tags/git/">git</a>
            </span>
            
            <span>
                <a href="/tags/github/">GitHub</a>
            </span>
            
            <span>
                <a href="/tags/graphics-engines/">Graphics-Engines</a>
            </span>
            
            <span>
                <a href="/tags/group-project/">Group Project</a>
            </span>
            
            <span>
                <a href="/tags/html/">HTML</a>
            </span>
            
            <span>
                <a href="/tags/hugo/">Hugo</a>
            </span>
            
            <span>
                <a href="/tags/java/">Java</a>
            </span>
            
            <span>
                <a href="/tags/javascript/">JavaScript</a>
            </span>
            
            <span>
                <a href="/tags/jekyll/">Jekyll</a>
            </span>
            
            <span>
                <a href="/tags/networking/">Networking</a>
            </span>
            
            <span>
                <a href="/tags/nginx/">Nginx</a>
            </span>
            
            <span>
                <a href="/tags/php/">PHP</a>
            </span>
            
            <span>
                <a href="/tags/server/">Server</a>
            </span>
            
            <span>
                <a href="/tags/smb/">SMB</a>
            </span>
            
            <span>
                <a href="/tags/ssh/">SSH</a>
            </span>
            
            <span>
                <a href="/tags/tls/">TLS</a>
            </span>
            
            <span>
                <a href="/tags/troubleshooting/">Troubleshooting</a>
            </span>
            
            <span>
                <a href="/tags/ufw/">UFW</a>
            </span>
            
            <span>
                <a href="/tags/unix/">Unix</a>
            </span>
            
        </div>
    </div>
    <div class="sidebar-item sidebar-toc">
        <h3>TOC</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#ansible">Ansible</a></li>
    <li><a href="#issue-1-general-syntax-problems">Issue 1: General Syntax Problems</a></li>
    <li><a href="#issue-2-php-installation">Issue 2: PHP Installation</a></li>
    <li><a href="#issue-3-affinity-installation">Issue 3: Affinity Installation</a></li>
    <li><a href="#issue-4-overthinking">Issue 4: Overthinking</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></div>
</aside>
        </div>
        <div class="btn">
    <div class="btn-menu" id="btn-menu">
        <i class="iconfont icon-grid-sharp"></i>
    </div>
    <div class="btn-toggle-mode">
        <i class="iconfont icon-contrast-sharp"></i>
    </div>
    <div class="btn-scroll-top">
        <i class="iconfont icon-chevron-up-circle-sharp"></i>
    </div>
</div>
<aside class="sidebar-mobile" style="display: none;">
  <div class="sidebar-wrapper">
    
    <div class="sidebar-item sidebar-pages">
        <h3>Pages</h3>
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/index.xml">RSS</a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-links">
        <h3>Links</h3>
        <ul>
            
            <li>
                <a href="https://github.com/RobertFleming448" target="_blank"><span>GitHub</span></a>
            </li>
            
            <li>
                <a href="https://www.linkedin.com/in/robert-fleming-16b4051b9/" target="_blank"><span>LinkedIn</span></a>
            </li>
            
        </ul>
    </div>
    
    <div class="sidebar-item sidebar-tags">
        <h3>Tags</h3>
        <div>
            
            <span>
                <a href="/tags/3d-models/">3d-Models</a>
            </span>
            
            <span>
                <a href="/tags/affinity/">Affinity</a>
            </span>
            
            <span>
                <a href="/tags/ansible/">Ansible</a>
            </span>
            
            <span>
                <a href="/tags/apache/">Apache</a>
            </span>
            
            <span>
                <a href="/tags/aws/">AWS</a>
            </span>
            
            <span>
                <a href="/tags/cit-480/">CIT-480</a>
            </span>
            
            <span>
                <a href="/tags/cit-481/">CIT-481</a>
            </span>
            
            <span>
                <a href="/tags/docker/">Docker</a>
            </span>
            
            <span>
                <a href="/tags/freebsd/">FreeBSD</a>
            </span>
            
            <span>
                <a href="/tags/git/">git</a>
            </span>
            
            <span>
                <a href="/tags/github/">GitHub</a>
            </span>
            
            <span>
                <a href="/tags/graphics-engines/">Graphics-Engines</a>
            </span>
            
            <span>
                <a href="/tags/group-project/">Group Project</a>
            </span>
            
            <span>
                <a href="/tags/html/">HTML</a>
            </span>
            
            <span>
                <a href="/tags/hugo/">Hugo</a>
            </span>
            
            <span>
                <a href="/tags/java/">Java</a>
            </span>
            
            <span>
                <a href="/tags/javascript/">JavaScript</a>
            </span>
            
            <span>
                <a href="/tags/jekyll/">Jekyll</a>
            </span>
            
            <span>
                <a href="/tags/networking/">Networking</a>
            </span>
            
            <span>
                <a href="/tags/nginx/">Nginx</a>
            </span>
            
            <span>
                <a href="/tags/php/">PHP</a>
            </span>
            
            <span>
                <a href="/tags/server/">Server</a>
            </span>
            
            <span>
                <a href="/tags/smb/">SMB</a>
            </span>
            
            <span>
                <a href="/tags/ssh/">SSH</a>
            </span>
            
            <span>
                <a href="/tags/tls/">TLS</a>
            </span>
            
            <span>
                <a href="/tags/troubleshooting/">Troubleshooting</a>
            </span>
            
            <span>
                <a href="/tags/ufw/">UFW</a>
            </span>
            
            <span>
                <a href="/tags/unix/">Unix</a>
            </span>
            
        </div>
    </div>
    
    
    
    <div class="sidebar-item sidebar-toc">
        <h3>TOC</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#ansible">Ansible</a></li>
    <li><a href="#issue-1-general-syntax-problems">Issue 1: General Syntax Problems</a></li>
    <li><a href="#issue-2-php-installation">Issue 2: PHP Installation</a></li>
    <li><a href="#issue-3-affinity-installation">Issue 3: Affinity Installation</a></li>
    <li><a href="#issue-4-overthinking">Issue 4: Overthinking</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
    
    
  </div>
</aside>
    </main>

    <footer>
    <div class="container-lg clearfix">
        <div class="col-12 footer">
            
            <span>&copy; 2020-2021
                <a href="https://robertfleming448.github.io">Robert Fleming</a>
                 | <a href="https://github.com/RobertFleming448/CIT_Blogs">Source code</a> 
                | Powered by <a href="https://github.com/dsrkafuu/hugo-theme-fuji/"
                   target="_blank">Fuji-v2</a> &amp; <a href="https://gohugo.io/"
                                                    target="_blank">Hugo</a> 
            </span>
        </div>
    </div>
</footer>

    
<script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.0/lazysizes.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>



<script defer src="/assets/js/fuji.min.js"></script>


</body>

</html>